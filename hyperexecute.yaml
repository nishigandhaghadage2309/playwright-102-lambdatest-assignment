# hyperexecute.yaml
version: 0.2

# Run on multiple OS & browsers using matrix
runson: ${matrix.os}

matrix:
  os: [win, linux]
  browser: [chromium, firefox]

# Global timeouts
globalTimeout: 45
testSuiteTimeout: 30
testSuiteStep: 15

env:
env:
  # Env vars used by config/tests
  BASE_URL: "https://www.lambdatest.com/selenium-playground/"
  CUSTOM_MESSAGE: "Welcome to LambdaTest from HyperExecute"


# Install dependencies before running tests
pre:
  - npm ci || npm install
  - npx playwright install --with-deps

# Cache node_modules based on package-lock.json checksum
cacheKey: '{{ checksum "package-lock.json" }}'
cacheDirectories:
  - node_modules

# Test command – run Playwright for each browser in matrix
testSuites:
  - npx playwright test --project=${matrix.browser}

# Enable job report in dashboard
report: true

# Artifacts – CORRECT STRUCTURE
uploadArtifacts:
  - name: playwright-report
    path:
      - playwright-report/**
  - name: test-results
    path:
      - test-results/**

mergeArtifacts: true

post:
  - echo "Playwright 102 suite finished on ${matrix.os} / ${matrix.browser}"

