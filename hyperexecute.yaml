# hyperexecute.yaml
version: 0.2

# Global timeouts
globalTimeout: 45
testSuiteTimeout: 30
testSuiteStep: 15

# Matrix to run on multiple OS & browsers
matrix:
  os: [win, linux]
  browser: [chromium, firefox]

# Runner OS
runson: linux

env:
  # Secrets from HyperExecute UI (DO NOT hardcode here)
  LT_USERNAME: ${{ .secrets.LT_USERNAME }}
  LT_ACCESS_KEY: ${{ .secrets.LT_ACCESS_KEY }}

  # Example env vars used in code/config (already supported in config & tests)
  BASE_URL: "https://www.lambdatest.com/selenium-playground/"
  CUSTOM_MESSAGE: "Welcome to LambdaTest from HyperExecute"

# Install dependencies before running tests
pre:
  - npm ci || npm install
  - npx playwright install --with-deps

# Cache node_modules based on package-lock.json checksum
cacheKey: "{{ checksum 'package-lock.json' }}"
cacheDirectories:
  - node_modules

# Test command – run Playwright for each browser in matrix
testSuites:
  - npx playwright test --project=${matrix.browser}

# Artifacts – upload reports & test-results
report: true
uploadArtifacts:
  - playwright-report/**
  - test-results/**
mergeArtifacts: true

post:
  - echo "Playwright 102 suite finished on ${matrix.os} / ${matrix.browser}"
